<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Butternut r√¥ti aux √âpices - Yat√© D., 3PMT</title>
    <!-- Chargement de Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chargement de Chart.js via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <!-- Police Inter de Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap" rel="stylesheet" />
    <style>
        /* Styles personnalis√©s */
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f7f7f7; 
        }

        .tab-button { 
            transition: all 0.2s; 
            padding: 0.75rem 1.5rem; 
            cursor: pointer; 
        }

        .active-tab { 
            border-bottom: 3px solid #F97316; /* orange-600 */
            font-weight: 700; 
            color: #F97316; /* orange-600 */
        }

        .chart-container { 
            position: relative; 
            width: 100%; 
            height: 150px; 
        }

        .step-checkbox:checked + .step-text { 
            text-decoration: line-through; 
            color: #9CA3AF; /* gray-400 */
        }

        .step-text { 
            transition: color 0.3s, text-decoration 0.3s; 
        }

        .step-checkbox { 
            transform: scale(1.2); 
            cursor: pointer;
        }

        /* Nouveaux styles pour les indicateurs de difficult√© (pour correspondre √† l'image) */
        .dot-filled {
            width: 20px;
            height: 20px;
            background-color: #F97316; /* Tailwind orange-600 */
            border-radius: 50%;
            transition: background-color 0.3s;
        }

        .dot-empty {
            width: 20px;
            height: 20px;
            border: 2px solid #FDBA74; /* Tailwind orange-300 */
            background-color: transparent;
            border-radius: 50%;
            transition: border-color 0.3s;
        }
    </style>
</head>
<body class="p-4 bg-gray-50">

    <div class="container mx-auto max-w-4xl bg-white rounded-xl shadow-2xl p-6 md:p-10 my-8">

        <p class="text-xl font-extrabold text-amber-600 mb-6 border-b border-amber-100 pb-2">
            üçÇ Recette de l'Automne
        </p>
        
        <header class="text-center mb-10 pb-6 border-b-4 border-orange-100">
            <h1 class="text-4xl md:text-5xl font-extrabold text-orange-700 mb-3 leading-snug flex items-center justify-center flex-wrap">
                <span class="text-4xl mr-2">üß°</span> BUTTERNUT R√îTI AUX √âPICES <span class="text-4xl ml-2">üß°</span>
            </h1>
            <p class="text-xl font-semibold text-green-600 mt-1 italic">par Yat√© D., 3PMT</p>
        </header>

        <section class="mb-8 flex flex-col md:flex-row gap-6">
            <div class="md:w-1/2">
                <h2 class="text-2xl font-bold text-stone-700 mb-3">Recette V√©g√©tarienne et Gourmande üçÅ</h2>
                <p class="text-gray-600 leading-relaxed">
                    Une mani√®re simple et d√©licieuse de cuisiner le Butternut. Le miel (ou sirop d'√©rable) et les √©pices apportent une saveur sucr√©e-sal√©e parfaite.
                </p>

                <!-- Bloc Niveau de Difficult√© -->
                <div class="mt-4 p-3 bg-[#FEF3C7] rounded-lg border border-[#FCD34D]">
                    <h3 id="difficulty-title" class="text-xl font-bold text-[#92400E] flex items-center mb-1">
                        <!-- Le titre est g√©n√©r√© par JavaScript -->
                    </h3>
                    <div id="difficulty-indicator" class="flex items-center gap-2 mt-2">
                        <!-- Les indicateurs (points) sont g√©n√©r√©s par JavaScript -->
                    </div>
                </div>

                <!-- NOUVEAU : Booster de Cuisson -->
                <div class="mt-4 p-4 bg-red-100 rounded-lg border border-red-300">
                    <h3 class="text-xl font-bold text-red-700 flex items-center mb-2">
                        <span class="text-2xl mr-2">‚ö°</span> Booster de Cuisson
                    </h3>
                    <p class="text-gray-700 text-sm leading-relaxed">
                        Pour un **butternut plus tendre et un gain de temps**, faites pr√©cuire les cubes √† la vapeur ou dans l'eau bouillante pendant **5 minutes** avant de les m√©langer avec les √©pices et de les enfourner. Cela r√©duit le temps de cuisson au four de pr√®s de 15 minutes.
                    </p>
                </div>

                <!-- NOUVEAU : Le Saviez-vous ? -->
                <div class="mt-4 p-4 bg-blue-100 rounded-lg border border-blue-300">
                    <h3 class="text-xl font-bold text-blue-700 flex items-center mb-2">
                        <span class="text-2xl mr-2">üí°</span> Le Saviez-vous? <span class="text-sm font-normal text-blue-500 ml-2">par Alice D., TMA</span>
                    </h3>
                    <p class="text-gray-700 text-sm leading-relaxed">
                        Saviez-vous que la couleur orange vif du Butternut est due √† sa richesse en **b√©tacarot√®nes** ? Ces pigments sont de puissants antioxydants, et sont aussi les pr√©curseurs de la **Vitamine A**, essentielle pour une bonne vision et la sant√© de la peau.
                    </p>
                </div>
            </div>

            <div class="md:w-1/2 p-4 bg-orange-50 rounded-xl border border-orange-200">
                <h3 class="text-xl font-bold text-orange-700 mb-3 text-center">‚è± Temps de la Recette</h3>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-3 text-center">
                    <div class="p-3 bg-white rounded-lg border">
                        <p class="text-3xl text-orange-600 mb-1">‚è≥</p>
                        <p class="text-xl font-bold text-orange-600" id="prep-time-display">15 min</p>
                        <p class="text-xs text-gray-500">Pr√©paration</p>
                    </div>
                    <div class="p-3 bg-white rounded-lg border">
                        <p class="text-3xl text-orange-600 mb-1">üî•</p>
                        <p class="text-xl font-bold text-orange-600" id="cook-time-display">35 min</p>
                        <p class="text-xs text-gray-500">Cuisson</p>
                    </div>
                    <div class="col-span-2 md:col-span-1 p-3 bg-orange-200 rounded-lg border-2 border-orange-300">
                        <p class="text-3xl text-orange-800 mb-1">‚è±</p>
                        <p class="text-2xl font-extrabold text-orange-800" id="total-time-display">50 min</p>
                        <p class="text-sm text-gray-700">Total estim√©</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="mb-10 p-6 bg-gray-50 rounded-xl">
            <h2 class="text-2xl font-bold text-stone-700 mb-4">Portions & Visualisation</h2>
            <div class="flex flex-col md:flex-row items-center justify-between gap-6">
                <div class="md:w-1/2 w-full">
                    <label for="portions" class="block text-lg font-medium text-gray-700 mb-2">üë• Choisir le nombre de portions :</label>
                    <input type="number" id="portions" value="4" min="1" max="12" class="w-full p-3 border rounded-lg text-2xl text-center shadow-md" />
                    <p class="text-sm text-gray-500 mt-2">Les quantit√©s seront mises √† jour automatiquement selon le nombre de portions.</p>
                </div>
                <div class="md:w-1/2 w-full chart-container">
                    <canvas id="timeChart"></canvas>
                </div>
            </div>
        </section>

        <section>
            <div class="flex border-b border-gray-200 mb-6">
                <button id="tab-ingredients" class="tab-button active-tab text-lg text-gray-700">Ingr√©dients</button>
                <button id="tab-preparation" class="tab-button text-lg text-gray-500">Pr√©paration</button>
            </div>

            <div id="content-ingredients" class="tab-content">
                <ul id="ingredients-list" class="space-y-4"></ul>
            </div>

            <div id="content-preparation" class="tab-content hidden">
                <ol id="preparation-list" class="space-y-4"></ol>
            </div>
        </section>

        <div class="mt-8 pt-4 border-t-2 border-orange-100 text-left">
            <a href="#" class="inline-flex items-center text-orange-600 hover:text-orange-800 font-semibold text-sm">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 transform rotate-90" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a1 1 0 01-.707-.293l-7-7a1 1 0 011.414-1.414L9 15.586V3a1 1 0 112 0v12.586l5.293-5.293a1 1 0 111.414 1.414l-7 7A1 1 0 0110 18z" clip-rule="evenodd" />
                </svg>
                Retour aux Recettes
            </a>
        </div>
        
    </div>

    <script>
        // Donn√©es de base de la recette
        const BASE_PORTIONS = 4;
        const BASE_PREP_TIME = 15; // minutes
        const BASE_COOK_TIME = 35; // minutes
        const DIFFICULTY_LEVEL = 1; // Niveau de difficult√© : 1=Facile, 2=Moyen, 3=Difficile

        // Donn√©es des ingr√©dients pour 4 portions
        const BASE_INGREDIENTS = [
            { name: "Butternut", base_quantity: 1, unit: "gros" },
            { name: "Miel ou Sirop d'√©rable", base_quantity: 4, unit: "cuill√®res √† soupe" },
            { name: "Huile d'olive", base_quantity: 2, unit: "cuill√®res √† soupe" },
            { name: "M√©lange d'√©pices (curry, paprika, cumin, etc.)", base_quantity: 2, unit: "cuill√®res √† caf√©" },
            { name: "Sel, Poivre", base_quantity: 1, unit: "selon go√ªt" },
            { name: "Graines de courge (pour garnir)", base_quantity: 2, unit: "cuill√®res √† soupe" },
        ];

        // √âtapes de pr√©paration
        const PREPARATION_STEPS = [
            "Pr√©chauffer le four √† 200¬∞C (thermostat 6-7).",
            "Laver et couper le butternut en deux. Retirer les graines et les filaments.",
            "Couper le butternut en cubes d'environ 2-3 cm. Il n'est pas n√©cessaire de l'√©plucher.",
            "Dans un grand saladier, m√©langer les cubes de butternut avec l'huile d'olive, le miel (ou sirop d'√©rable), les √©pices, le sel et le poivre.",
            "R√©partir les cubes sur une plaque de cuisson recouverte de papier sulfuris√©, en une seule couche.",
            "Enfourner et cuire pendant 30 √† 35 minutes, jusqu'√† ce que le butternut soit tendre et l√©g√®rement caram√©lis√©.",
            "Saupoudrer de graines de courge juste avant de servir. D√©guster chaud !",
        ];


        // Variables pour le graphique
        let timeChart;

        // --- Fonctions d'affichage et de mise √† jour ---

        /**
         * Met √† jour la liste des ingr√©dients en fonction du nombre de portions.
         * @param {number} currentPortions - Le nombre de portions souhait√©.
         */
        function updateIngredients(currentPortions) {
            const list = document.getElementById('ingredients-list');
            list.innerHTML = ''; // Vider la liste existante

            const factor = currentPortions / BASE_PORTIONS;

            BASE_INGREDIENTS.forEach(ing => {
                const li = document.createElement('li');
                li.className = 'flex items-center p-3 bg-white rounded-lg shadow-sm border border-gray-100';

                let quantityText = '';
                if (ing.unit !== 'selon go√ªt') {
                    const newQuantity = Math.round(ing.base_quantity * factor * 10) / 10; // Arrondi √† 1 d√©cimale
                    
                    if (ing.unit === "gros") { // Pour le Butternut
                        quantityText = `<span class="font-extrabold text-orange-600 mr-2">${newQuantity.toFixed(1)}</span> ${ing.unit}`;
                    } else if (newQuantity === 0) {
                        quantityText = 'une pinc√©e';
                    } else {
                        quantityText = `<span class="font-extrabold text-orange-600 mr-2">${newQuantity}</span> ${ing.unit}`;
                    }

                } else {
                    quantityText = ing.unit;
                }

                li.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-orange-400 mr-3 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    <span class="text-gray-700 font-medium">${ing.name}</span>
                    <span class="ml-auto text-gray-500">${quantityText}</span>
                `;
                list.appendChild(li);
            });
        }

        /**
         * Affiche le niveau de difficult√© avec 5 points et met √† jour le titre (selon le style de l'image fournie).
         * @param {number} level - Niveau (1=Facile, 2=Moyen, 3=Difficile).
         */
        function displayDifficulty(level) {
            const indicator = document.getElementById('difficulty-indicator');
            const titleElement = document.getElementById('difficulty-title');
            indicator.innerHTML = '';
            
            let levelText = '';
            let filledDots = 0;
            const totalDots = 5;

            // Mapping des 3 niveaux √† l'affichage sur 5 points
            if (level === 1) {
                levelText = 'Facile';
                filledDots = 2; // 2/5 pour Facile (correspond au visuel de l'image)
            } else if (level === 2) {
                levelText = 'Moyen';
                filledDots = 3; // 3/5 pour Moyen (niveau actuel de la recette)
            } else { // level === 3 or other
                levelText = 'Difficile';
                filledDots = 5; // 5/5 pour Difficile
            }

            // Mise √† jour du titre
            titleElement.innerHTML = `üßë‚Äçüç≥ Niveau de Difficult√© (${levelText})`;
            
            // Affichage des 5 points (remplis ou vides)
            for (let i = 0; i < totalDots; i++) {
                const dot = document.createElement('div');
                dot.className = i < filledDots ? 'dot-filled' : 'dot-empty';
                indicator.appendChild(dot);
            }
        }


        /**
         * Met √† jour l'affichage des temps et le graphique.
         * @param {number} currentPortions - Le nombre de portions actuel.
         */
        function updateTimes(currentPortions) {
            // Le temps de pr√©paration et de cuisson est ajust√© non-lin√©airement
            const portionRatio = currentPortions / BASE_PORTIONS;
            
            // On augmente le temps si les portions sont beaucoup plus grandes, mais pas de mani√®re lin√©aire
            let prepIncreaseFactor = 1;
            let cookIncreaseFactor = 1;

            if (portionRatio > 1.5) {
                // Augmentation l√©g√®re pour les tr√®s grandes quantit√©s (plus de d√©coupe)
                prepIncreaseFactor = 1 + (portionRatio - 1.5) * 0.1; 
                cookIncreaseFactor = 1 + (portionRatio - 1.5) * 0.05; 
            }
            
            const currentPrepTime = Math.round(BASE_PREP_TIME * prepIncreaseFactor);
            const currentCookTime = Math.round(BASE_COOK_TIME * cookIncreaseFactor);
            const totalTime = currentPrepTime + currentCookTime;

            document.getElementById('prep-time-display').textContent = `${currentPrepTime} min`;
            document.getElementById('cook-time-display').textContent = `${currentCookTime} min`;
            document.getElementById('total-time-display').textContent = `${totalTime} min`;

            updateChart(currentPrepTime, currentCookTime);
        }

        /**
         * Affiche les √©tapes de pr√©paration.
         */
        function displayPreparationSteps() {
            const list = document.getElementById('preparation-list');
            list.innerHTML = ''; // Vider la liste existante

            PREPARATION_STEPS.forEach((step, index) => {
                const li = document.createElement('li');
                li.className = 'flex items-start p-4 bg-white rounded-lg shadow-md border-l-4 border-orange-500';

                li.innerHTML = `
                    <input type="checkbox" id="step-${index}" class="step-checkbox mt-1 mr-3 h-5 w-5 text-orange-600 rounded border-gray-300 focus:ring-orange-500 flex-shrink-0">
                    <label for="step-${index}" class="step-text text-gray-700 leading-relaxed">
                        <span class="font-bold text-lg text-orange-700 mr-2">${index + 1}.</span> ${step}
                    </label>
                `;
                list.appendChild(li);

                // Ajout de l'√©v√©nement pour la mise √† jour visuelle (barrage)
                document.getElementById(`step-${index}`).addEventListener('change', (e) => {
                    const label = e.target.nextElementSibling;
                    if (e.target.checked) {
                        label.classList.add('line-through', 'text-gray-400');
                    } else {
                        label.classList.remove('line-through', 'text-gray-400');
                    }
                });
            });
        }


        /**
         * Cr√©e ou met √† jour le graphique √† barres.
         * @param {number} prepTime - Temps de pr√©paration en minutes.
         * @param {number} cookTime - Temps de cuisson en minutes.
         */
        function updateChart(prepTime, cookTime) {
            const ctx = document.getElementById('timeChart').getContext('2d');

            const data = {
                labels: ['Pr√©paration', 'Cuisson'],
                datasets: [{
                    data: [prepTime, cookTime],
                    backgroundColor: ['#F97316', '#DC2626'], // Orange-600, Red-600
                    borderWidth: 1,
                    borderRadius: 5,
                    barPercentage: 0.7,
                    categoryPercentage: 0.8
                }]
            };

            const config = {
                type: 'bar',
                data: data,
                options: {
                    indexAxis: 'y', // Barres horizontales
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false,
                        },
                        tooltip: {
                            callbacks: {
                                label: (context) => {
                                    return context.parsed.x + ' minutes';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Temps (minutes)',
                                font: { size: 14 }
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            };

            if (timeChart) {
                timeChart.data.datasets[0].data = [prepTime, cookTime];
                timeChart.update();
            } else {
                timeChart = new Chart(ctx, config);
            }
        }


        // --- Gestion des √©v√©nements et Initialisation ---

        // 1. √âv√©nement de mise √† jour des portions
        document.getElementById('portions').addEventListener('input', (event) => {
            const newPortions = parseInt(event.target.value);
            if (newPortions >= 1) {
                updateIngredients(newPortions);
                updateTimes(newPortions);
            }
        });

        // 2. Gestion des onglets (Ingr√©dients / Pr√©paration)
        const tabIngredients = document.getElementById('tab-ingredients');
        const tabPreparation = document.getElementById('tab-preparation');
        const contentIngredients = document.getElementById('content-ingredients');
        const contentPreparation = document.getElementById('content-preparation');

        function switchTab(activeTab, inactiveTab, activeContent, inactiveContent) {
            activeTab.classList.add('active-tab', 'text-gray-700');
            activeTab.classList.remove('text-gray-500');
            inactiveTab.classList.remove('active-tab', 'text-gray-700');
            inactiveTab.classList.add('text-gray-500');

            activeContent.classList.remove('hidden');
            inactiveContent.classList.add('hidden');
        }

        tabIngredients.addEventListener('click', () => {
            switchTab(tabIngredients, tabPreparation, contentIngredients, contentPreparation);
        });

        tabPreparation.addEventListener('click', () => {
            switchTab(tabPreparation, tabIngredients, contentPreparation, contentIngredients);
        });


        // 3. Initialisation au chargement de la page
        function init() {
            displayDifficulty(DIFFICULTY_LEVEL);
            // Initialiser les donn√©es avec le nombre de portions de base (4)
            updateIngredients(BASE_PORTIONS);
            displayPreparationSteps();
            updateTimes(BASE_PORTIONS);
        }

        // Lancer l'initialisation apr√®s le chargement du DOM
        document.addEventListener('DOMContentLoaded', init);
    </script>

</body>
</html>
